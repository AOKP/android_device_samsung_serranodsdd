From 1d5a86199091a048e673fc45d65def61a026ad6f Mon Sep 17 00:00:00 2001
From: k2wl <k2wl@github.com>
Date: Tue, 12 Aug 2014 04:11:56 +0530
Subject: [PATCH] adding dual sim ril daemon support to init files at boot

Change-Id: I3f8f4cb44b11f1dd706a2c844f7df40f28b64c33
Signed-off-by: k2wl <k2wl@github.com>
---
 rootdir/init.qcom.ril.sh | 38 ++++++++++++++++++++++++++++++++++++++
 rootdir/init.target.rc   |  5 +++++
 2 files changed, 43 insertions(+)
 create mode 100755 rootdir/init.qcom.ril.sh

diff --git a/rootdir/init.qcom.ril.sh b/rootdir/init.qcom.ril.sh
new file mode 100755
index 0000000..c98c617
--- /dev/null
+++ b/rootdir/init.qcom.ril.sh
@@ -0,0 +1,38 @@
+#!/system/bin/sh
+# Copyright (c) 2012, The Linux Foundation. All rights reserved.
+#
+# Redistribution and use in source and binary forms, with or without
+# modification, are permitted provided that the following conditions are met:
+#     * Redistributions of source code must retain the above copyright
+#       notice, this list of conditions and the following disclaimer.
+#     * Redistributions in binary form must reproduce the above copyright
+#       notice, this list of conditions and the following disclaimer in the
+#       documentation and/or other materials provided with the distribution.
+#     * Neither the name of The Linux Foundation nor
+#       the names of its contributors may be used to endorse or promote
+#       products derived from this software without specific prior written
+#       permission.
+#
+# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+# IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+# NON-INFRINGEMENT ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
+# CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
+# EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
+# PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
+# OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
+# WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
+# OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
+# ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+#
+
+#
+# start two rild when dsds property enabled
+#
+dsds=`getprop persist.multisim.config`
+if [ "$dsds" = "dsds" ]; then
+    setprop ro.multi.rild true
+    stop ril-daemon
+    start ril-daemon
+    start ril-daemon1
+fi
diff --git a/rootdir/init.target.rc b/rootdir/init.target.rc
index 73f703d..f5cfd0b 100644
--- a/rootdir/init.target.rc
+++ b/rootdir/init.target.rc
@@ -35,6 +35,11 @@ on early-init
     mkdir /efs 0771 system radio
     chmod 644 /proc/cmdline
 
+service ril-qmi /system/bin/sh /init.qcom.ril.sh
+    class main
+    user root
+    oneshot
+
 on fs
     mount_all fstab.qcom
 
-- 
1.9.1

